# koa实现知乎关注与粉丝的数据结构

## 分析关注与分析的数据结构

我们是否要把关注和粉丝都设计成列表呢？

- 显然是不行的，如果一个大V粉丝有100万，那么这个用户下就要存100万条粉丝用户的信息，这样设计是不合理的。
所以我们把关注设置成一个Schema，粉丝可以通过user表来限制条件获取。

## models/user.js

1. 首先我们要在user集合中添加关注字段, 以便于我们将来通过following字段来获取对应的用户

```js{10-13}
const mongoose = require('mongoose');

const { Schema, model } = mongoose;

const userSchema = new Schema({
  __v: { type: Number, select: false },
  name: { type: String, required: true },
  password: { type: String, required: true, select: false },
  // ......
  following: {
    // { type: Schema.Types.ObjectId, ref: 'User' } 这行代码表示引用User集合中的数据
    // 规定就这么写
    type: [{ type: Schema.Types.ObjectId, ref: 'User' }],
    select: false,
  },
}, { timestamps: true });

module.exports = model('User', userSchema);
```

2. 获取粉丝和关注接口
